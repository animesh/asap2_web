 <% attr = @attrs[attr_name] %>
 <% form_attr_name = "attrs[" + attr_name + "]" %>
 <% if attr['widget']!='checkbox' and attr['widget']!='hidden' %>
  <%= label_tag form_attr_name, attr['label'], {'data-toggle' => 'tooltip', 'title' => attr['description'], 'class' => horiz_element['label_class'] || 'col-md-6'} %>
 <% end %>
 <% if attr['widget']=='input_data' %>
  <%= render :partial => 'input_data', :locals => {:attr_name => attr_name, :attr => attr} %>
 <% elsif attr['widget']=='textfield' %>
  <%= text_field_tag form_attr_name, @h_attrs[attr_name] || attr['default'] || '', {:class => "form-control", :placeholder => ""} %>
 <% elsif attr['widget']=='hidden' %>
  <%= hidden_field_tag form_attr_name, @h_attrs[attr_name] || attr['default'] || '', {:class => "form-control", :placeholder => ""} %>
 <% elsif attr['widget']=='checkbox' %>
 <% h_checkbox = {:placeholder => "", 'data-toggle' => 'tooltip', 'title' => attr['description'], 'class' => 'std_form_checkbox'} %>
 <%# h_checkbox[:checked] = false %>
 <%# h_checkbox[:checked] = true if (@h_attrs[attr_name] and @h_attrs[attr_name] != false) or (!@h_attrs[attr_name] and attr['default'] != false) %>
 <%# [(@ps.status_id != nil and @h_attrs[attr_name] and @h_attrs[attr_name] != false) , (!@ps.status_id and !@h_attrs[attr_name] and attr['default'] != false)].to_json %>
 <%# @h_attrs.to_json %>
 <%# h_checkbox.to_json %>
 <%# ((@h_attrs[attr_name] and @h_attrs[attr_name] != false) or (!@h_attrs[attr_name] and attr['default'] != false)).to_json %>
 <%= check_box_tag attr_name, '1', ((@ps.status_id != nil and @h_attrs[attr_name] and @h_attrs[attr_name] != false) or (!@ps.status_id and !@h_attrs[attr_name] and attr['default'] != false)),  h_checkbox %>
 <%= label_tag form_attr_name, attr['label'], {'data-toggle' => 'tooltip', 'title' => attr['description']} %>
 <% elsif attr['widget'] == 'select' %>
 <% l = [] %>
 <% if attr['min_val'] and attr['max_val'] %>
 <% l = (attr['min_val'] .. attr['max_val']).to_a.map{|e| [e, e]}.sort %>
 <% elsif attr['list'] %>
 <% l = attr['list'] %>
 <% end %>
 <% l.unshift([((attr['null_name']) ? attr['null_name'] : "None"), nil]) if !attr['not_null'] %>
 <%= select_tag form_attr_name, options_for_select(l, @h_attrs[attr_name] || attr['default']), {class: 'form-control'} %>
 <% end %>
 
 <% if attr_name == 'batch_file_exists' %>
 <b>using <a href='https://www.bu.edu/jlab/wp-assets/ComBat/Abstract.html' target='_blank'>ComBat</a>.</b>
 <% end %>
 <% if (attr_name == 'batch_file_exists' or attr_name == 'batch_file') and editable? @project %>
  <span>To add a batch file <span id='edit_project_link' class='btn btn-default btn-xs' class='edit_project'>Edit project</span> </span>
 <% end %>
    
